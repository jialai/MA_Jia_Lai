<!-- Load the Polymer.Element base class -->
<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/iron-input/iron-input.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">

<dom-module id="my-timeseries">
    <!-- Defines the element's style and local DOM -->
    <template>
        <style>
        :host {
            display: block;

            padding: 16px;
        }

        button.apply_button {
            color: white;
            background: #3f51b5;
            border: 1px #303f94 solid;
            box-shadow: inset 0 1px 0 #303f94;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
            border-bottom-right-radius: 5px;
            border-bottom-left-radius: 5px;
            padding: 6px;

        }

        button.apply_button:hover {
            border: 1px #d43913 solid;
            box-shadow: 0 1px 1px #d43913, inset 0 1px 0 #d43913;
            background: #dd2c00;
        }

        button.apply_button:active {
            box-shadow: inset 0 2px 5px #2370FE;
        }

        button {
            margin-left: 10px;
            margin-right: 10px;
        }



        .nameofparameter {
            color: #737373;
            padding-top: 0px;
            padding-right: 6px;
            padding-bottom: 0px;
            padding-left: 6px;

        }

        .parameterBorder {
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
            border-bottom-right-radius: 5px;
            border-bottom-left-radius: 5px;

            padding-top: 0px;
            padding-right: 6px;
            padding-bottom: 0px;
            padding-left: 6px;
            margin: 1em;

        }

        .wrap {
            display: -webkit-box;
        }

        .line {
            fill: none;
            stroke: steelblue;
            stroke-width: 1.5px;
        }

        .zoom {
            cursor: move;
            fill: none;
            pointer-events: all;
        }
        </style>
        <!-- <iron-ajax id="ajaxGetPatterns" auto url="http://localhost:8081/algorithm/get-patterns" method="get" params='{"MinSupport":"0.1", "MaxPatternLength":"5"}'  handle-as="json"  on-response="handleResponse" last-response="{{patterns}}">
        </iron-ajax> -->
        <iron-ajax id="ajaxGetPatterns" 
        method="get"
        auto url="http://localhost:8081/algorithm/parameters/get-patterns" 
        handle-as="json" on-response="handleResponse" debounce-duration="300">
        </iron-ajax>
        <!-- params='{{_getParams()}}' -->
        <!--  -->
        <!-- '{"MinSupport":"0.5", "MaxPatternLength":"5"}' -->
         
        <!--up line and zoom are for svg-->
        <h1 align="center">Time Series Data Analysis</h1>
        <td colspan="2">
            <div align="center"><b>Patterns<b><br> <textarea name="Patterns" cols="120" rows="30"></textarea>
            </div>
            
        </td>


    <form>
        <br>
        <br><br>
        <div class="wrap">
            <div>
                <b>Time Series:<b>
              <!--   <label class="nameofparameter">MinSupport</label>  
                <iron-input slot="input" bind-value="{{formData}}">
                  <input class="parameterBorder" id="MinSupport" type="text" name="MinSupport",value="{{formData}}">
                </iron-input> -->
                <label class="nameofparameter">MinSupport </label>
                  <iron-input slot="input" bind-value="{{formData}}">
                <input class="parameterBorder" id="MinSupport" type="text" name="MinSupport", value="{{formData::input}}">
                </iron-input>

                <span></span>
            </div>
            <div>
                <label class="nameofparameter">MaxPatternLength </label>
                  <iron-input slot="input" bind-value="{{dataform}}">
                <input class="parameterBorder" id="MaxPatternLength" type="text" name="MaxPatternLength", value="{{dataform::input}}">
                </iron-input>
                <!-- <button class="apply_button" onclick="getPatterns">Apply</button> -->
                <paper-button raised on-tap="apply" >Apply</paper-button>
            </div>

        </div>

    </form>

  </template>
  <script>
    class MyTimeseries extends Polymer.Element{
      static get is (){return 'my-timeseries';}
      static get properties() {
          return {
              formData: {
                type: String,
                value:'0.5',
                notify: true,
                reflectToAttribute: true
              },
              dataform: {
                type: String,
                value:'8',
                notify: true,
                reflectToAttribute: true
              },
              error: String
          }
      }

      apply(){
        // alert('start the request');
        // self.body = '{"MinSupport":"0.3", "MaxPatternLength":"5"}';
        alert(this.formData)
        alert(this.dataform)
        this.$.ajaxGetPatterns.set( 'params', {"MinSupport": this.formData, "MaxPatternLength": this.dataform});
        this.$.ajaxGetPatterns.generateRequest();
      }
      // _getParams() {
      //   // var mins = document.querySelector('#MinSupport').value
      //   // var maxl = document.querySelector('#MaxPatternLength').value

      //   // console.log(mins);
      //   // alert(this.$.MinSupport.value)
      //   alert(this.formData)
      //  return {"MinSupport": this.formData, "MaxPatternLength": this.dataform};
      // }
    }
    window.customElements.define(MyTimeseries.is,MyTimeseries);
  </script>>
</dom-module>